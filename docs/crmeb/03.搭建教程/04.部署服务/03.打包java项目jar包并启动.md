---
title: 打包Java项目jar并启动
date: 2021-12-22 12:37:44
permalink: /pages/crmeb/java-build-run/
categories:
  - crmeb
  - 安装教程
tags:
  - 
---
# Crmeb Java 项目打包可运行jar文件

本地已经运行过的同学直接配置prod环境的yml文件后直接mvn install 打包即可。

## ⏬下载的源码，并导入开发工具

解压后的代码包内容

![源码包基本内容介绍](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281444821.png)

解压后导入idea开发工具，初次导入会自动根据pom文件下载对应的jar包。

![下载jar，取决于你的网速](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203261556769.png)

## 🔗正确导入java项目并配置mysql和redis链接

![正确导入Java项目](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203261558982.png)

 配置数据库连接和

![打包jar文件](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203261626692.png)

打包之前修改环境配置文件，分别在crmeb-admin 和 crmeb-front包下的 yml，每个环境中的端口都不一样，这里默认admin为20000front为20001 上传到服务端口转发会用到，也可以根据自己要求调整，不要不冲突即可。

crmeb-admin		Admin服务		 打包后产出Crmeb-admin.jar

crmeb-comm		公共服务   		 会打包到admin和front中

crmeb-front   		商城服务			打包后产出Crmeb-front.jar

crmeb-service		公共业务			会打包到admin和front中

crmebiamge			素材包				线上部署时需要上传到服务器，将路径配置到java 配置文件中

✅打包成功

![打包Jar文件成功](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203261637385.png)

打包后在对应目录获取到Crmeb-admin.jar 和 Crmeb-front.jar 并发布到宝塔创建的两个api.xxx的域名下。

上传代码到服务端可以使用自己趁手的工具，ftp或者ssh 这里为了统一，都是用宝塔面板操作。

![获取打包后的jar文件](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281048079.png)

上传打包好的两个jar文件到创建好的站点根目录

![上传jar到宝塔对应api站点](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281052132.png)

如下图，以admin服务为例 上传Crmeb-admin.jar ，启动jar的shell，和初始化素材包 shell文件和素材包都在压缩包中。

![上传jar和shell脚本](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281109524.png)

> 注意: shell脚本在执行时可能会出现格式不正确的问题，可以在本地修改好在bt面板中创建.sh文件直接粘贴进去就好。

⚠️素材说明：上图中crmebimage目录需要在admin 对应环境的 yml中提前配置好，目录层级到crmebimage的第一层目录。

点击start.sh文件修改路径，stop.sh 一般不需要重启直接执行start.sh文件，停止时一般手动kill，如果需要stop.sh脚本同样配置目录即可。

![修改启动脚本](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281128937.png)

同样front也上传jar和脚本到对应目录即可，素材自在admin端配置。

万事俱备，开始启动jar程序。

链接SSH客户端

![宝塔中打开终端](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281138409.png)

执行启动命令

![image-20220328113605612](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281136685.png)

☕️admin.jar 启动成功，这里不再列举front的上传和启动，和admin一样的操作即可，front不用配置素材的差异其他一致。

![启动Java程序成功](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281145850.png)

### 设置代理 对外提供api服务

在没有设置代理之前的api站点访问是这样的，如果不是，需要确认域名解析和宝塔中创建站点哪个环节出了问题。

![代理之前的api站点](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281149523.png)

![image-20220328115212668](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281152707.png)

设置Admin服务代理端口

![设置adminAPI代理](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281154830.png)

访问admin swagger文档：访问方式 | http://域名/doc.html

![访问admin swagger文档](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281158285.png)

同样访问front api 需要和admin jar 一样正确部署并且启动后，设置代理端口 默认20001 如果有修改以自己修改的端口为准。

![front jar Swagger](https://cdn.jsdelivr.net/gh/xbdazz/mypic/img/202203281205324.png)

以上步骤已经将java全部服务启动成功！

👍👍👍👍👍👍👍👍 java打包过程中如果出现错误等问题环境论坛提问 [Java系统 - CRMEB社区](https://q.crmeb.com/?categoryId=122&sequence=0)
